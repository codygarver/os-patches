From d3048a29797ee2d80d84bbda26bb3c954584f332 Mon Sep 17 00:00:00 2001
From: Eirik Aavitsland <eirik.aavitsland@theqtcompany.com>
Date: Wed, 11 Mar 2015 09:00:41 +0100
Subject: [PATCH] Fixes crash in gif image decoder

Fuzzing test revealed that for certain malformed gif files,
qgifhandler would segfault.

Change-Id: I5bb6f60e1c61849e0d8c735edc3869945e5331c1
Reviewed-by: Richard J. Moore <rich@kde.org>
---
 src/gui/image/qgifhandler.cpp |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

Index: qt4-x11-4.8.5+git192-g085f851+dfsg/src/gui/image/qgifhandler.cpp
===================================================================
--- qt4-x11-4.8.5+git192-g085f851+dfsg.orig/src/gui/image/qgifhandler.cpp	2015-05-25 13:48:57.787653924 -0400
+++ qt4-x11-4.8.5+git192-g085f851+dfsg/src/gui/image/qgifhandler.cpp	2015-05-25 13:48:57.787653924 -0400
@@ -944,6 +944,8 @@
 
 void QGIFFormat::nextY(unsigned char *bits, int bpl)
 {
+    if (out_of_bounds)
+        return;
     int my;
     switch (interlace) {
     case 0: // Non-interlaced
